var nickInput = document.getElementById('nickInput');
var messageInput = document.getElementById('messageInput');
var chatArea = document.getElementById('chatArea');
var sendButton = document.getElementById('sendButton');

//показываем историю в чате
function showMessagesList(list) {
	for (i = 0; i < list.length; i++) {
		var template = "<div><strong>" + list[i].nick + ": </strong>" + list[i].mess+"</div>";	
		chatArea.innerHTML += template;
	}
}

//звгружаем историю сообщений из localStorage
if (!localStorage.getItem("chat"))
	localStorage.setItem("chat", JSON.stringify([]));

var chatHistory = JSON.parse(localStorage.getItem("chat"));
showMessagesList(chatHistory);



var i=0;

sendButton.addEventListener('click', function() {
	
	if (document.getElementById('nickInput').value == ""){
		alert("please enter nickname");
		return;
	}
	if (document.getElementById('messageInput').value == ""){
		alert("please enter message");
		return;
	}

	var message={
		nick: nickInput.value,
		mess: messageInput.value
	};

	chatHistory.push(message);
	
	nickInput.Value = "";
	messageInput.value = "";
	
    localStorage.setItem("chat", JSON.stringify(chatHistory));
	
	localData = localStorage.getItem("chat");
    localData = JSON.parse(localData);
	
	var template="<div><strong>"+localData[i].nick+": </strong>"+localData[i].mess+"</div>";
	
	i++;
    chatArea.innerHTML += template;
	chatArea.scrollTop=chatArea.scrollHeight;
	
});

clearButton.addEventListener('click', function() {
	localStorage.clear();
	chatArea.innerHTML="";	
});


function check() {
  var nick = document.getElementById('nickInput'),
      message = document.getElementById('messageInput');
  document.getElementById('sendButton').disabled = nick.value && message.value ? false : "disabled";
}